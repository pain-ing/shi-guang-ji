# 拾光集 (Shi Guang Ji) - 实施指南文档

**版本:** 1.0
**日期:** 2025年9月7日

---

### 1. 概述

本指南为 "拾光集" 项目的开发团队提供了一套标准的开发流程、代码规范和协作方式，旨在确保项目高效、高质量地完成。

---

### 2. 开发环境搭建

1.  **必备工具:**
    * Node.js (LTS 版本)
    * pnpm (推荐，用于包管理)
    * Git & GitHub/GitLab 账户
    * VS Code (推荐，及相关插件如 ESLint, Prettier)
    * Supabase CLI
    * Vercel CLI

2.  **项目初始化:**
    * `git clone [项目仓库地址]`
    * `pnpm install`
    * 创建 `.env.local` 文件，并根据 `.env.example` 填入从 Supabase 项目获取的 `SUPABASE_URL` 和 `SUPABASE_ANON_KEY`。
    * 运行 `pnpm dev` 启动本地开发服务器。

3.  **Supabase 本地开发:**
    * 安装 Supabase CLI: `npm install supabase --save-dev`
    * 本地初始化: `supabase init`
    * 关联远程项目: `supabase link --project-ref [你的项目ID]`
    * 拉取远程数据库结构: `supabase db pull`
    * 启动本地服务: `supabase start` (这将在本地运行一个 Docker 容器，包含 Supabase 的所有服务)

---

### 3. 代码规范

* **语言:** TypeScript。所有新代码都必须使用 TypeScript 编写，并开启严格模式。
* **格式化:**
    * 统一使用 Prettier进行代码格式化，并配置为在保存时自动格式化。
    * 使用 ESLint进行代码质量检查，遵循社区推荐的规则集 (如 `eslint-config-next`)。
* **命名规范:**
    * **组件:** 大驼峰命名法 (PascalCase)，如 `DatePicker.tsx`。
    * **变量/函数:** 小驼峰命名法 (camelCase)，如 `getUserProfile`。
    * **常量:** 大写下划线命名法 (SNAKE_CASE)，如 `MAX_UPLOAD_SIZE`。
* **组件开发:**
    * 遵循原子设计原则，优先构建可复用的基础组件。
    * 组件的 props 必须有明确的类型定义。

---

### 4. Git 工作流

* **分支模型:** 采用 Git Flow 的简化版。
    * `main`: 主分支，始终保持可部署状态。只有在发布新版本时才从 `develop` 合并。
    * `develop`: 开发主分支，所有新功能分支都从这里创建。
    * `feature/[功能名]`: 功能开发分支，如 `feature/diary-editor`。开发完成后合并到 `develop`。
* **提交信息 (Commit Message):**
    * 遵循 Conventional Commits 规范。
    * 格式: `<type>(<scope>): <subject>`，例如 `feat(diary): add markdown support for editor`。
    * `type` 可以是 `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore` 等。

---

### 5. 部署流程 (CI/CD)

1.  **关联 Vercel 与 GitHub 仓库:** 在 Vercel 上创建一个新项目，并将其与你的 GitHub/GitLab 仓库关联。
2.  **环境变量配置:** 将 `.env.local` 中的环境变量配置到 Vercel 项目的 "Environment Variables" 设置中。
3.  **自动部署:**
    * **生产环境:** 每当有新的提交合并到 `main` 分支时，Vercel 会自动构建并部署到生产环境。
    * **预览环境:** 每当创建一个新的 Pull Request 到 `develop` 或 `main` 分支时，Vercel 会自动为该 PR 创建一个唯一的预览环境。这对于在合并前进行代码审查和测试非常有用。
4.  **Supabase 数据库迁移:**
    * 数据库结构的变更应通过创建新的迁移文件来管理 (`supabase migration new <name>`)。
    * 在本地修改后，使用 `supabase db push` 将变更应用到本地数据库。
    * 部署到生产环境时，需要通过 CI/CD 流程运行 `supabase db push` 将迁移应用到远程的 Supabase 数据库。

---